@model List<WebApplication1.Models.Author>

    

@{
    ViewBag.Title = "ClosedXML_Index";
}

<h2>ClosedXML_Index</h2>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<body>
    <h4>Customers</h4>
    <hr />
    @*<table cellpadding="0" cellspacing="0">
            <tr>
                <th>CustomerID</th>
                <th>Contact Name</th>
            </tr>
            @foreach (var customer in Model)
            {
                <tr>
                    <td>@customer.id</td>
                    <td>@customer.AuthorName.ToString()</td>
                </tr>
            }
        </table>*@
    <br />
    <br />
    @using (Html.BeginForm("ClosedXML_Export", "Home", FormMethod.Post, new { id = "loginForm" }))
    {
        @*<input type="text" name="usename" />
        <input type="text" name="usename2" />*@
        <input type="submit" value="Export" />
    }
</body>
</html>

@section scripts{
    <script>
        $(function () {

            $("#loginForm").submit(function (e) {
                e.preventDefault();
                //https://forums.asp.net/t/2147748.aspx
                //https://stackoverflow.com/questions/47315763/validate-username-and-password-without-postback-in-login-form-asp-net-mvc
                $.post($(this).attr("action"), $(this).serialize())
                    .done(function (response) {
                        window.open($(this).attr("href"));

                        //redirect current page to success page
                        window.location = "https://www.baidu.com/";
                        window.focus();
                    });
            });
        });
    </script>
}